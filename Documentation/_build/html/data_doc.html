

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>data module &mdash; OpenDenoising 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="evaluation module" href="evaluation_doc.html" />
    <link rel="prev" title="model module" href="model_doc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> OpenDenoising
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation guide.</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="benchmark_api_doc.html">Benchmark API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="model_doc.html">model module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-data">Data generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-data">Artificial Noises</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-data">Preprocessing Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="evaluation_doc.html">evaluation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmarking_doc.html">Benchmark Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">OpenDenoising</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="benchmark_api_doc.html">Benchmark API</a> &raquo;</li>
        
      <li>data module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/data_doc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="data-module">
<h1>data module<a class="headerlink" href="#data-module" title="Permalink to this headline">¶</a></h1>
<p>This module extends <a class="reference external" href="https://keras.io/utils/">keras.utils.Sequence</a>. dataset generators for the three main cases in image denoising:</p>
<ol class="arabic simple">
<li><p><strong>Clean Dataset:</strong> Only clean (ground-truth) images are available. Hence, you will need to specify a function to
corrupt the clean images, so that you can train your network with pairs (noisy, clean). On the section Artificial
Noises, we cover built-in functions for adding noise to clean images.</p></li>
<li><p><strong>Full Dataset:</strong> Both clean and noisy images are available. In that case, the dataset yields the image paris (clean,
noisy).</p></li>
<li><p><strong>Blind Dataset:</strong> Only noisy images are available. These datasets can be used for qualitative avaliation.</p></li>
</ol>
<p>We remark that these classes can be used for training and inference on our Benchmark. It is also noteworthy that MatlabModel
objects, which are based on Matlab Deep Learning Toolbox, need to use the MatlabDatasetWrapper to be efficiently trained.
For more information, look at <a class="reference internal" href="#data.MatlabDatasetWrapper" title="data.MatlabDatasetWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">data.MatlabDatasetWrapper</span></code></a> and <code class="xref py py-class docutils literal notranslate"><span class="pre">model.MatlabModel</span></code> classes documentation.</p>
<p>Along with these classes, we also provide built-in functionalities for preprocessing, such as Data Augmentation and
patch extraction. These are covered in the <strong>Preprocessing Functions</strong> section.</p>
<div class="section" id="module-data">
<span id="data-generation"></span><h2>Data generation<a class="headerlink" href="#module-data" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="data.AbstractDatasetGenerator">
<em class="property">class </em><code class="sig-prename descclassname">data.</code><code class="sig-name descname">AbstractDatasetGenerator</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">batch_size=32</em>, <em class="sig-param">shuffle=True</em>, <em class="sig-param">name='AbstractDataset'</em>, <em class="sig-param">n_channels=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/abstract_dataset.html#AbstractDatasetGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.AbstractDatasetGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">keras.utils.data_utils.Sequence</span></code></p>
<p>Dataset generator based on Keras library. implementation based on
<a class="reference external" href="https://stanford.edu/~shervine/blog/keras-how-to-generate-data-on-the-fly">https://stanford.edu/~shervine/blog/keras-how-to-generate-data-on-the-fly</a></p>
<dl class="attribute">
<dt id="data.AbstractDatasetGenerator.path">
<code class="sig-name descname">path</code><a class="headerlink" href="#data.AbstractDatasetGenerator.path" title="Permalink to this definition">¶</a></dt>
<dd><p>String containing the path to image files directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.AbstractDatasetGenerator.batch_size">
<code class="sig-name descname">batch_size</code><a class="headerlink" href="#data.AbstractDatasetGenerator.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of image batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.AbstractDatasetGenerator.n_channels">
<code class="sig-name descname">n_channels</code><a class="headerlink" href="#data.AbstractDatasetGenerator.n_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>1 for grayscale, 3 for RGB.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.AbstractDatasetGenerator.shuffle">
<code class="sig-name descname">shuffle</code><a class="headerlink" href="#data.AbstractDatasetGenerator.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to shuffle the dataset at each epoch or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#bool" title="(in Python v3.5)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.AbstractDatasetGenerator.channels_first">
<code class="sig-name descname">channels_first</code><a class="headerlink" href="#data.AbstractDatasetGenerator.channels_first" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether data is formatted as (BatchSize, Height, Width, Channels) or (BatchSize, Channels, Height, Width).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#bool" title="(in Python v3.5)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.AbstractDatasetGenerator.name">
<code class="sig-name descname">name</code><a class="headerlink" href="#data.AbstractDatasetGenerator.name" title="Permalink to this definition">¶</a></dt>
<dd><p>String containing the dataset’s name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="data.AbstractDatasetGenerator.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">batch_size=32</em>, <em class="sig-param">shuffle=True</em>, <em class="sig-param">name='AbstractDataset'</em>, <em class="sig-param">n_channels=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/abstract_dataset.html#AbstractDatasetGenerator.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.AbstractDatasetGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="data.AbstractDatasetGenerator.__len__">
<code class="sig-name descname">__len__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/abstract_dataset.html#AbstractDatasetGenerator.__len__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.AbstractDatasetGenerator.__len__" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of batches per epoch</p>
</dd></dl>

<dl class="method">
<dt id="data.AbstractDatasetGenerator.__str__">
<code class="sig-name descname">__str__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/abstract_dataset.html#AbstractDatasetGenerator.__str__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.AbstractDatasetGenerator.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the dataset name.</p>
</dd></dl>

<dl class="method">
<dt id="data.AbstractDatasetGenerator.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/abstract_dataset.html#AbstractDatasetGenerator.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.AbstractDatasetGenerator.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines and shuffles indexes on epoch end</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="data.BlindDatasetGenerator">
<em class="property">class </em><code class="sig-prename descclassname">data.</code><code class="sig-name descname">BlindDatasetGenerator</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">batch_size=32</em>, <em class="sig-param">shuffle=True</em>, <em class="sig-param">name='CleanDataset'</em>, <em class="sig-param">n_channels=1</em>, <em class="sig-param">preprocessing=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/blind_dataset.html#BlindDatasetGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.BlindDatasetGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">OpenDenoising.data.abstract_dataset.AbstractDatasetGenerator</span></code></p>
<p>Dataset generator based on Keras library. This class is used for Blind denoising problems, where only noisy
images are available.</p>
<dl class="attribute">
<dt id="data.BlindDatasetGenerator.path">
<code class="sig-name descname">path</code><a class="headerlink" href="#data.BlindDatasetGenerator.path" title="Permalink to this definition">¶</a></dt>
<dd><p>String containing the path to image files directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.BlindDatasetGenerator.batch_size">
<code class="sig-name descname">batch_size</code><a class="headerlink" href="#data.BlindDatasetGenerator.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of image batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.BlindDatasetGenerator.n_channels">
<code class="sig-name descname">n_channels</code><a class="headerlink" href="#data.BlindDatasetGenerator.n_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>1 for grayscale, 3 for RGB.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.BlindDatasetGenerator.shuffle">
<code class="sig-name descname">shuffle</code><a class="headerlink" href="#data.BlindDatasetGenerator.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to shuffle the dataset at each epoch or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#bool" title="(in Python v3.5)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.BlindDatasetGenerator.name">
<code class="sig-name descname">name</code><a class="headerlink" href="#data.BlindDatasetGenerator.name" title="Permalink to this definition">¶</a></dt>
<dd><p>String containing the dataset’s name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.BlindDatasetGenerator.preprocessing">
<code class="sig-name descname">preprocessing</code><a class="headerlink" href="#data.BlindDatasetGenerator.preprocessing" title="Permalink to this definition">¶</a></dt>
<dd><p>List of preprocessing functions, which will be applied to each image.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#list" title="(in Python v3.5)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="data.BlindDatasetGenerator.__getitem__">
<code class="sig-name descname">__getitem__</code><span class="sig-paren">(</span><em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/blind_dataset.html#BlindDatasetGenerator.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.BlindDatasetGenerator.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate batches of images.</p>
</dd></dl>

<dl class="method">
<dt id="data.BlindDatasetGenerator.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">batch_size=32</em>, <em class="sig-param">shuffle=True</em>, <em class="sig-param">name='CleanDataset'</em>, <em class="sig-param">n_channels=1</em>, <em class="sig-param">preprocessing=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/blind_dataset.html#BlindDatasetGenerator.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.BlindDatasetGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="data.BlindDatasetGenerator.__next__">
<code class="sig-name descname">__next__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/blind_dataset.html#BlindDatasetGenerator.__next__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.BlindDatasetGenerator.__next__" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns image batches sequentially.</p>
</dd></dl>

<dl class="method">
<dt id="data.BlindDatasetGenerator.__repr__">
<code class="sig-name descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/blind_dataset.html#BlindDatasetGenerator.__repr__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.BlindDatasetGenerator.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="data.CleanDatasetGenerator">
<em class="property">class </em><code class="sig-prename descclassname">data.</code><code class="sig-name descname">CleanDatasetGenerator</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">batch_size=32</em>, <em class="sig-param">noise_config=None</em>, <em class="sig-param">shuffle=True</em>, <em class="sig-param">name='CleanDataset'</em>, <em class="sig-param">n_channels=1</em>, <em class="sig-param">preprocessing=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/clean_dataset.html#CleanDatasetGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.CleanDatasetGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">OpenDenoising.data.abstract_dataset.AbstractDatasetGenerator</span></code></p>
<p>Dataset generator based on Keras library. This class is used for non-blind denoising problems where only clean
images are available. To use such dataset to train denoising networks, you need to specify a type of artificial
noise that will be added to each clean image.</p>
<dl class="attribute">
<dt id="data.CleanDatasetGenerator.path">
<code class="sig-name descname">path</code><a class="headerlink" href="#data.CleanDatasetGenerator.path" title="Permalink to this definition">¶</a></dt>
<dd><p>String containing the path to image files directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.CleanDatasetGenerator.batch_size">
<code class="sig-name descname">batch_size</code><a class="headerlink" href="#data.CleanDatasetGenerator.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of image batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.CleanDatasetGenerator.n_channels">
<code class="sig-name descname">n_channels</code><a class="headerlink" href="#data.CleanDatasetGenerator.n_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>1 for grayscale, 3 for RGB.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.CleanDatasetGenerator.shuffle">
<code class="sig-name descname">shuffle</code><a class="headerlink" href="#data.CleanDatasetGenerator.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to shuffle the dataset at each epoch or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#bool" title="(in Python v3.5)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.CleanDatasetGenerator.channels_first">
<code class="sig-name descname">channels_first</code><a class="headerlink" href="#data.CleanDatasetGenerator.channels_first" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether data is formatted as (BatchSize, Height, Width, Channels) or (BatchSize, Channels, Height, Width).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#bool" title="(in Python v3.5)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.CleanDatasetGenerator.name">
<code class="sig-name descname">name</code><a class="headerlink" href="#data.CleanDatasetGenerator.name" title="Permalink to this definition">¶</a></dt>
<dd><p>String containing the dataset’s name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.CleanDatasetGenerator.preprocessing">
<code class="sig-name descname">preprocessing</code><a class="headerlink" href="#data.CleanDatasetGenerator.preprocessing" title="Permalink to this definition">¶</a></dt>
<dd><p>List of preprocessing functions, which will be applied to each image.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#list" title="(in Python v3.5)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.CleanDatasetGenerator.noise_config">
<code class="sig-name descname">noise_config</code><a class="headerlink" href="#data.CleanDatasetGenerator.noise_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary whose keys are functions implementing the noise process, and the value is a list containing the noise
function parameters. If you do not want to specify any parameters, your list should be empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#dict" title="(in Python v3.5)">dict</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<p>The following example corresponds to a Dataset Generator which reads images from “./images”, yields batches of
length 32, applies Gaussian noise with intensity drawn uniformely from the range [0, 55] followed by
“Super Resolution noise” of intensity 4. Moreover, the dataset shuffles the data, yields them in NHWC format,
and does not apply any preprocessing function. <strong>NOTE</strong>: your list should be in the same order as your arguments.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">OpenDenoising</span> <span class="k">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise_config</span> <span class="o">=</span> <span class="p">{</span><span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">gaussian_blind_noise</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">super_resolution_noise</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datagen</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">CleanDatasetGenerator</span><span class="p">(</span><span class="s2">&quot;./images&quot;</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">noise_config</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;MyData&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="data.CleanDatasetGenerator.__getitem__">
<code class="sig-name descname">__getitem__</code><span class="sig-paren">(</span><em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/clean_dataset.html#CleanDatasetGenerator.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.CleanDatasetGenerator.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates batches of data.</p>
</dd></dl>

<dl class="method">
<dt id="data.CleanDatasetGenerator.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">batch_size=32</em>, <em class="sig-param">noise_config=None</em>, <em class="sig-param">shuffle=True</em>, <em class="sig-param">name='CleanDataset'</em>, <em class="sig-param">n_channels=1</em>, <em class="sig-param">preprocessing=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/clean_dataset.html#CleanDatasetGenerator.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.CleanDatasetGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="data.CleanDatasetGenerator.__repr__">
<code class="sig-name descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/clean_dataset.html#CleanDatasetGenerator.__repr__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.CleanDatasetGenerator.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<dl class="method">
<dt id="data.CleanDatasetGenerator.__str__">
<code class="sig-name descname">__str__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/clean_dataset.html#CleanDatasetGenerator.__str__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.CleanDatasetGenerator.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the dataset name.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="data.FullDatasetGenerator">
<em class="property">class </em><code class="sig-prename descclassname">data.</code><code class="sig-name descname">FullDatasetGenerator</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">batch_size=32</em>, <em class="sig-param">shuffle=True</em>, <em class="sig-param">name='FullDataset'</em>, <em class="sig-param">n_channels=1</em>, <em class="sig-param">preprocessing=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/full_dataset.html#FullDatasetGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.FullDatasetGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">OpenDenoising.data.abstract_dataset.AbstractDatasetGenerator</span></code></p>
<p>Dataset generator based on Keras library. This class is used for non-blind denoising problems. Unlike
ClenDatasetGenerator class, this class corresponds to the case where both clean and noisy samples are available and
paired (for each noisy image, there is one and only one clean image with same filename).</p>
<dl class="attribute">
<dt id="data.FullDatasetGenerator.path">
<code class="sig-name descname">path</code><a class="headerlink" href="#data.FullDatasetGenerator.path" title="Permalink to this definition">¶</a></dt>
<dd><p>String containing the path to image files directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.FullDatasetGenerator.batch_size">
<code class="sig-name descname">batch_size</code><a class="headerlink" href="#data.FullDatasetGenerator.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of image batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.FullDatasetGenerator.n_channels">
<code class="sig-name descname">n_channels</code><a class="headerlink" href="#data.FullDatasetGenerator.n_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>1 for grayscale, 3 for RGB.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.FullDatasetGenerator.shuffle">
<code class="sig-name descname">shuffle</code><a class="headerlink" href="#data.FullDatasetGenerator.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to shuffle the dataset at each epoch or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#bool" title="(in Python v3.5)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.FullDatasetGenerator.name">
<code class="sig-name descname">name</code><a class="headerlink" href="#data.FullDatasetGenerator.name" title="Permalink to this definition">¶</a></dt>
<dd><p>String containing the dataset’s name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.FullDatasetGenerator.preprocessing">
<code class="sig-name descname">preprocessing</code><a class="headerlink" href="#data.FullDatasetGenerator.preprocessing" title="Permalink to this definition">¶</a></dt>
<dd><p>List of preprocessing functions, which will be applied to each image.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#list" title="(in Python v3.5)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="data.FullDatasetGenerator.__getitem__">
<code class="sig-name descname">__getitem__</code><span class="sig-paren">(</span><em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/full_dataset.html#FullDatasetGenerator.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.FullDatasetGenerator.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate batches of data</p>
</dd></dl>

<dl class="method">
<dt id="data.FullDatasetGenerator.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">batch_size=32</em>, <em class="sig-param">shuffle=True</em>, <em class="sig-param">name='FullDataset'</em>, <em class="sig-param">n_channels=1</em>, <em class="sig-param">preprocessing=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/full_dataset.html#FullDatasetGenerator.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.FullDatasetGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="data.FullDatasetGenerator.__next__">
<code class="sig-name descname">__next__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/full_dataset.html#FullDatasetGenerator.__next__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.FullDatasetGenerator.__next__" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns image batches sequentially.</p>
</dd></dl>

<dl class="method">
<dt id="data.FullDatasetGenerator.__repr__">
<code class="sig-name descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/full_dataset.html#FullDatasetGenerator.__repr__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.FullDatasetGenerator.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="data.MatlabDatasetWrapper">
<em class="property">class </em><code class="sig-prename descclassname">data.</code><code class="sig-name descname">MatlabDatasetWrapper</code><span class="sig-paren">(</span><em class="sig-param">engine</em>, <em class="sig-param">images_path='./tmp/BSDS500/Train/ref'</em>, <em class="sig-param">partition='Train'</em>, <em class="sig-param">ext=None</em>, <em class="sig-param">patch_size=40</em>, <em class="sig-param">n_patches=16</em>, <em class="sig-param">noiseFcn=&quot;&#64;(I) imnoise(I</em>, <em class="sig-param">'gaussian'</em>, <em class="sig-param">0</em>, <em class="sig-param">25/255)&quot;</em>, <em class="sig-param">channel_format='grayscale'</em>, <em class="sig-param">type='Clean'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/matlab_dataset_wrapper.html#MatlabDatasetWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.MatlabDatasetWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.5/library/functions.html#object" title="(in Python v3.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class wraps FullMatlabDataset and CleanMatlabDataset classes. It makes internal calls to Matlab through
Python Matlab’s engine to load one these classes into the workspace.</p>
<p class="rubric">Notes</p>
<p>This functions does not implement the interface provided by keras.utils.Sequence. It should only be used alongside
with MatlabModel objects.</p>
<dl class="attribute">
<dt id="data.MatlabDatasetWrapper.engine">
<code class="sig-name descname">engine</code><a class="headerlink" href="#data.MatlabDatasetWrapper.engine" title="Permalink to this definition">¶</a></dt>
<dd><p>Matlab engine instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">matlab.engine.MatlabEngine</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.MatlabDatasetWrapper.images_path">
<code class="sig-name descname">images_path</code><a class="headerlink" href="#data.MatlabDatasetWrapper.images_path" title="Permalink to this definition">¶</a></dt>
<dd><p>String to directory containing dataset’s images.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.MatlabDatasetWrapper.partition">
<code class="sig-name descname">partition</code><a class="headerlink" href="#data.MatlabDatasetWrapper.partition" title="Permalink to this definition">¶</a></dt>
<dd><p>String containing the dataset partition (‘Train’, ‘Valid’ or ‘Test’).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.MatlabDatasetWrapper.ext">
<code class="sig-name descname">ext</code><a class="headerlink" href="#data.MatlabDatasetWrapper.ext" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary holding images extensions. Note that this dictionary should have keys only.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#dict" title="(in Python v3.5)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.MatlabDatasetWrapper.patch_size">
<code class="sig-name descname">patch_size</code><a class="headerlink" href="#data.MatlabDatasetWrapper.patch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of patches to be extracted.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.MatlabDatasetWrapper.n_patches">
<code class="sig-name descname">n_patches</code><a class="headerlink" href="#data.MatlabDatasetWrapper.n_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of patches to be extracted on each image.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.MatlabDatasetWrapper.noiseFcn">
<code class="sig-name descname">noiseFcn</code><a class="headerlink" href="#data.MatlabDatasetWrapper.noiseFcn" title="Permalink to this definition">¶</a></dt>
<dd><p>For CleanDataset only. Specifies the noising function that will be applied to images. It should be a function
that accepts as input an image, and returns another image. If you need to specify parameters, you can do so by
using Matlab’s anonymous function syntax (by specifying noiseFcn=”&#64;(I) imnoise(I, ‘gaussian’, 0, 25/255)”), for
instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.MatlabDatasetWrapper.channel_format">
<code class="sig-name descname">channel_format</code><a class="headerlink" href="#data.MatlabDatasetWrapper.channel_format" title="Permalink to this definition">¶</a></dt>
<dd><p>String containing ‘grayscale’ for grayscale images, or ‘RGB’ for RGB images.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="data.MatlabDatasetWrapper.type">
<code class="sig-name descname">type</code><a class="headerlink" href="#data.MatlabDatasetWrapper.type" title="Permalink to this definition">¶</a></dt>
<dd><p>String containing Clean (for CleanDataset) or Full (for FullDataset).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)">str</a></p>
</dd>
</dl>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">model.MatlabModel</span></code></dt><dd><p>for the type of model for which this class was designed to interact.</p>
</dd>
</dl>
</div>
<dl class="method">
<dt id="data.MatlabDatasetWrapper.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/matlab_dataset_wrapper.html#MatlabDatasetWrapper.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.MatlabDatasetWrapper.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
</dd></dl>

<dl class="method">
<dt id="data.MatlabDatasetWrapper.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">engine</em>, <em class="sig-param">images_path='./tmp/BSDS500/Train/ref'</em>, <em class="sig-param">partition='Train'</em>, <em class="sig-param">ext=None</em>, <em class="sig-param">patch_size=40</em>, <em class="sig-param">n_patches=16</em>, <em class="sig-param">noiseFcn=&quot;&#64;(I) imnoise(I</em>, <em class="sig-param">'gaussian'</em>, <em class="sig-param">0</em>, <em class="sig-param">25/255)&quot;</em>, <em class="sig-param">channel_format='grayscale'</em>, <em class="sig-param">type='Clean'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/matlab_dataset_wrapper.html#MatlabDatasetWrapper.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.MatlabDatasetWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-data">
<span id="artificial-noises"></span><h2>Artificial Noises<a class="headerlink" href="#module-data" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="data.gaussian_noise">
<code class="sig-prename descclassname">data.</code><code class="sig-name descname">gaussian_noise</code><span class="sig-paren">(</span><em class="sig-param">ref</em>, <em class="sig-param">noise_level=15</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/utils/corrupt.html#gaussian_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.gaussian_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian noise</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Image to be noised.</p></li>
<li><p><strong>noise_level</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Level of corruption. Always give the noise_level in terms of 0-255 pixel intensity range.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>inp</strong> – Noised image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="data.poisson_noise">
<code class="sig-prename descclassname">data.</code><code class="sig-name descname">poisson_noise</code><span class="sig-paren">(</span><em class="sig-param">ref</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/utils/corrupt.html#poisson_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.poisson_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Poisson noise</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ref</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Image to be noised.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>inp</strong> – Noised image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="data.salt_and_pepper_noise">
<code class="sig-prename descclassname">data.</code><code class="sig-name descname">salt_and_pepper_noise</code><span class="sig-paren">(</span><em class="sig-param">ref</em>, <em class="sig-param">noise_level=15</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/utils/corrupt.html#salt_and_pepper_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.salt_and_pepper_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Salt and pepper noise</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Image to be noised.</p></li>
<li><p><strong>noise_level</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Percentage of perturbed pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>inp</strong> – Noised image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="data.speckle_noise">
<code class="sig-prename descclassname">data.</code><code class="sig-name descname">speckle_noise</code><span class="sig-paren">(</span><em class="sig-param">ref</em>, <em class="sig-param">noise_level=15</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/utils/corrupt.html#speckle_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.speckle_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Speckle noise</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Image to be noised.</p></li>
<li><p><strong>noise_level</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Percentage of perturbed pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>inp</strong> – Noised image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="data.super_resolution_noise">
<code class="sig-prename descclassname">data.</code><code class="sig-name descname">super_resolution_noise</code><span class="sig-paren">(</span><em class="sig-param">ref</em>, <em class="sig-param">noise_level=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/utils/corrupt.html#super_resolution_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.super_resolution_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Noise due to down-sampling followed by up-sampling an image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Image to be noised.</p></li>
<li><p><strong>noise_level</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – scaling factor. For instance, for an image (512, 512), a factor 2 down-samples the image to (256, 256), then
up-samples it again to (512, 512).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>inp</strong> – Noised image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-data">
<span id="preprocessing-functions"></span><h2>Preprocessing Functions<a class="headerlink" href="#module-data" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="data.dncnn_augmentation">
<code class="sig-prename descclassname">data.</code><code class="sig-name descname">dncnn_augmentation</code><span class="sig-paren">(</span><em class="sig-param">inp</em>, <em class="sig-param">ref=None</em>, <em class="sig-param">aug_times=1</em>, <em class="sig-param">channels_first=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/utils/preprocessing.html#dncnn_augmentation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.dncnn_augmentation" title="Permalink to this definition">¶</a></dt>
<dd><p>Data augmentation policy employed on DnCNN</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Noised image.</p></li>
<li><p><strong>ref</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Ground-truth images.</p></li>
<li><p><strong>aug_times</strong> (<a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)"><em>int</em></a>) – Number of times augmentation if applied.</p></li>
<li><p><strong>channels_first</strong> (<em>boo</em>) – Whether data is formatted as NCHW (True) or NHWC (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>inp</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Augmented noised images</p></li>
<li><p><strong>ref</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Augmented ground-truth images</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="data.gen_patches">
<code class="sig-prename descclassname">data.</code><code class="sig-name descname">gen_patches</code><span class="sig-paren">(</span><em class="sig-param">inp</em>, <em class="sig-param">ref</em>, <em class="sig-param">patch_size</em>, <em class="sig-param">channels_first=False</em>, <em class="sig-param">mode='sequential'</em>, <em class="sig-param">n_patches=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/utils/preprocessing.html#gen_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.gen_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Patch generation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Noised image which patches will be extracted.</p></li>
<li><p><strong>ref</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Reference image which patches will be extracted.</p></li>
<li><p><strong>patch_size</strong> (<a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)"><em>int</em></a>) – Size of patch window (number of pixels in each axis).</p></li>
<li><p><strong>channels_first</strong> (<a class="reference external" href="https://docs.python.org/3.5/library/functions.html#bool" title="(in Python v3.5)"><em>bool</em></a>) – Whether data is formatted as NCHW (True) or NHWC (False).</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3.5/library/stdtypes.html#str" title="(in Python v3.5)"><em>str</em></a>) – One between {‘sequential’, ‘random’}. If mode = ‘sequential’, extracts patches sequentially on each axis.
If mode = ‘random’, extracts patches randomly.</p></li>
<li><p><strong>n_patches</strong> (<a class="reference external" href="https://docs.python.org/3.5/library/functions.html#int" title="(in Python v3.5)"><em>int</em></a>) – <p>Number of patches to be extracted from the image. Should be specified only if mode = ‘random’. If not specified,
then,</p>
<div class="math notranslate nohighlight">
\[n\_patches = \dfrac{h \times w}{patch_{size}^{2}}\]</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>input_patches</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Extracted input patches.</p></li>
<li><p><strong>reference_patches</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Extracted reference patches.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="evaluation_doc.html" class="btn btn-neutral float-right" title="evaluation module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="model_doc.html" class="btn btn-neutral float-left" title="model module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Eduardo Montesuma, Florian Lemarchand

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>