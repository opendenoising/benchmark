

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Example: creating datasets &mdash; OpenDenoising 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Filtering Model tutorial" href="FilteringModel.html" />
    <link rel="prev" title="Example: running evaluation" href="BenchmarkTutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> OpenDenoising
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation guide.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmark_api_doc.html">Benchmark API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../examples.html#basic-examples">Basic Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="BenchmarkTutorial.html">Example: running evaluation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Example: creating datasets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cleandatasetgenerator-class">CleanDatasetGenerator Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fulldatasetgenerator-class">FullDatasetGenerator Class</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#in-depth-tutorials">In-depth Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#jupyter-notebooks">Jupyter Notebooks</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OpenDenoising</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>Example: creating datasets</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Examples/DataTutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="example-creating-datasets">
<h1>Example: creating datasets<a class="headerlink" href="#example-creating-datasets" title="Permalink to this headline">¶</a></h1>
<p>Here we present a tutorial on how you can use the OpenDenoising data module to provide data to your denoising algorithms.
You should follow the snippets on this tutorial sequentially.</p>
<p>First, being on the project’s root, you need to import the necessary modules,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">OpenDenoising</span> <span class="kn">import</span> <span class="n">data</span>
<span class="kn">from</span> <span class="nn">skimage.measure</span> <span class="kn">import</span> <span class="n">compare_psnr</span>
</pre></div>
</div>
<div class="section" id="cleandatasetgenerator-class">
<h2>CleanDatasetGenerator Class<a class="headerlink" href="#cleandatasetgenerator-class" title="Permalink to this headline">¶</a></h2>
<p>Many Deep Learning models for image restoration are trained using <strong>artificial types of noise</strong>. In such setting, one
have a dataset of clean images, that is, images without any kind of noise or degradation process. To train the network,
these images are noised using artificial noise models, such as <strong>gaussian noise</strong> or <strong>salt and pepper noise</strong>.</p>
<p>We call these datasets containing only <strong>ground-truth images</strong> a “clean dataset”, and they are handled by the class
CleanDatasetGenerator. For mode details on how you can artificially add noise to images, look at the
<em>Artificial Noising</em> section.</p>
<p>During this section, we will base our analysis on the dataset used to train <a class="reference external" href="https://arxiv.org/pdf/1608.03981.pdf">DnCNN</a> network. The dataset used is called Berkeley Segmentation Dataset (BSDS),
consisting of 500 images. For training, BSDS consider 400 cropped images, and further uses 68 images not present on
training data for validation/testing.</p>
<p>Additionally, each dataset type has a specific folder structure. We suppose that your Clean Datasets have the following
structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DatasetName</span><span class="o">/</span>
<span class="o">|--</span> <span class="n">Train</span>
<span class="o">|</span>   <span class="o">|--</span> <span class="n">ref</span>
<span class="o">|--</span> <span class="n">Valid</span>
<span class="o">|</span>   <span class="o">|--</span> <span class="n">ref</span>
</pre></div>
</div>
<div class="section" id="downloading-bsds-dataset">
<h3>Downloading BSDS Dataset<a class="headerlink" href="#downloading-bsds-dataset" title="Permalink to this headline">¶</a></h3>
<p>The benchmark include a tool for automatically download the <a class="reference external" href="https://github.com/aGIToz/KerasDnCNN/tree/master/genData">training</a>
and <a class="reference external" href="https://github.com/cszn/DnCNN/blob/master/testsets/BSD68">validation</a> datasets from Github pages.
These datasets may be further be saved to a “./tmp” folder, as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">download_BSDS_grayscale</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;./tmp/BSDS500/&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-a-cleandatasetgenerator">
<h3>Creating a CleanDatasetGenerator<a class="headerlink" href="#creating-a-cleandatasetgenerator" title="Permalink to this headline">¶</a></h3>
<p>To create a Clean Dataset, you can use the DatasetFactory class by specifying the following parameters:</p>
<ul class="simple">
<li><p><strong>batch_size</strong>: Following <a class="reference external" href="https://arxiv.org/pdf/1608.03981.pdf">DnCNN’s paper</a>, the number of patches per batch is 128.
However, the batch_size corresponds to the number of images into each batch. Considering a patch size of 40, we end up
with 16 times more patches than images. Hence, to end up with 128 patches per batch, we need 8 images per batch.</p></li>
<li><p><strong>n_channels</strong>: as our images are grayscale, n_channels = 1</p></li>
<li><p><strong>preprocessing</strong>: Following <a class="reference external" href="https://arxiv.org/pdf/1608.03981.pdf">DnCNN’s paper</a>, we need to extract <span class="math notranslate nohighlight">\(40 \times 40\)</span>
patches from the images we just downloaded. We can do this by using the function “data.gen_patches”.</p></li>
<li><p><strong>name</strong>: we will specify “BSDS_Train” as the dataset’s name.</p></li>
<li><p><strong>noise_config</strong>: Here we can configure the artificial noise that will be added to each image sample <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.
For our first example, we will add gaussian noise with intensity $sigma=25$ (always specified with respect to 0-255 range).</p></li>
</ul>
<p>These specifications are specified by the following snippet,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">n_channels</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">patch_size</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">channels_first</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">noise_config</span> <span class="o">=</span> <span class="p">{</span><span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">gaussian_noise</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">]}</span>
<span class="n">preprocessing</span> <span class="o">=</span> <span class="p">[</span><span class="n">partial</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">gen_patches</span><span class="p">,</span> <span class="n">patch_size</span><span class="o">=</span><span class="n">patch_size</span><span class="p">,</span> <span class="n">channels_first</span><span class="o">=</span><span class="n">channels_first</span><span class="p">)]</span>
</pre></div>
</div>
<p>With these configurations, you can create your train and valid generators,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_generator</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DatasetFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;./tmp/BSDS500/Train&quot;</span><span class="p">,</span>
                                             <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                                             <span class="n">n_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                             <span class="n">noise_config</span><span class="o">=</span><span class="n">noise_config</span><span class="p">,</span>
                                             <span class="n">preprocessing</span><span class="o">=</span><span class="n">preprocessing</span><span class="p">,</span>
                                             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;BSDS_Train&quot;</span><span class="p">)</span>

<span class="n">valid_generator</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DatasetFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;./tmp/BSDS500/Valid&quot;</span><span class="p">,</span>
                                             <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                                             <span class="n">n_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                             <span class="n">noise_config</span><span class="o">=</span><span class="n">noise_config</span><span class="p">,</span>
                                             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;BSDS_Valid&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that we need to specify the path to the root folder, and not to “ref”. The “ref” folder, in that case, is the only
folder containing images (as we generate noisy images at execution time). Using these two instances of our class, we may
generate images that will be fed to Deep Learning models for training and inference,</p>
<p>The instances of DatasetGenerator class behave as if they were lists. Being so, you can loop through its contents by
using list comprehension. For instance,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">Xbatch</span><span class="p">,</span> <span class="n">Ybatch</span> <span class="ow">in</span> <span class="n">train_generator</span><span class="p">:</span>
    <span class="c1"># Do something</span>
</pre></div>
</div>
<p>will read the images on “./tmp” and output “Xbatch” (noisy images) and “Ybatch” (clean images). You may also use the
Python built-in function <em>next</em>, which reads data sequentially. Moreover, to see the images generated by the generator
you may run the following snippet,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Xbatch</span><span class="p">,</span> <span class="n">Ybatch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">train_generator</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">Xbatch</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Ground-Truth&quot;</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">Ybatch</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Noised Patch&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="BSDS patches outputted by train_generator." src="../_images/DataTutorialOut1.png" />
<p>To see the images in valid_generator, a similar snippet can be run,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Xbatch</span><span class="p">,</span> <span class="n">Ybatch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">valid_generator</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">Xbatch</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Ground-Truth&quot;</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">Ybatch</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Noised Patch&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="BSDS patches outputted by valid_generator." src="../_images/DataTutorialOut2.png" />
</div>
<div class="section" id="artificial-noising">
<h3>Artificial Noising<a class="headerlink" href="#artificial-noising" title="Permalink to this headline">¶</a></h3>
<p>In this section we provide the details for adding artificial noise into clean images. First, we cover the basic corruption
functions in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">OpenDenoising.data</span></code> module,</p>
<p><strong>Gaussian Noise</strong></p>
<p>For additive noises, such as the Gaussian Noise, the noised images <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> obeys the following expression,</p>
<div class="math notranslate nohighlight">
\[\mathbf{y} = \mathbf{x} + \mathbf{\epsilon},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> the ground-truth and <span class="math notranslate nohighlight">\(\mathbf{\epsilon}\)</span> the noise component. For the Gaussian Noise model,
<span class="math notranslate nohighlight">\(\mathbf{\epsilon} \sim \mathcal{N}(0, \sigma^{2})\)</span>, that is, is an Additive White Gaussian Noise (it is additive,
and has zero mean).</p>
<p>The main parameter controlling the level of Gaussian Noise is the variance <span class="math notranslate nohighlight">\(\sigma\)</span>. Considering its specification,
it is noteworthy that the value of <span class="math notranslate nohighlight">\(\sigma\)</span>, and consequently the impact of such noise on the outcome <span class="math notranslate nohighlight">\(\mathbf{y}\)</span>
is dependent on the range of the original image <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. As a convention, we remark that $sigma$ should be
specified with respect to the uint8 range, that is, [0, 255].</p>
<p>The following snippet shows an example of images contaminated with gaussian noise,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../../tmp/BSDS500/Train/ref/test_400.png&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Reads a grayscale image</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span> <span class="c1"># uint8 =&gt; float32</span>

<span class="n">y_1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">gaussian_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y_2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">gaussian_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">y_3</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">gaussian_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">y_4</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">gaussian_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">y_5</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">gaussian_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Gaussian Noise&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ground-truth image&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\sigma$=10&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\sigma$=15&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\sigma$=25&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_4</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\sigma$=40&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\sigma$=50&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Summary of Gaussian Noise." src="../_images/DataTutorialOut3.png" />
<p><strong>Remark:</strong> a similar kind of noise is specified by <code class="xref py py-mod docutils literal notranslate"><span class="pre">data.utils.gaussian_blind_noise</span></code>, which is used, for instance,
to train the DnCNN network for Blind denoising (noised images only). In that case, the <span class="math notranslate nohighlight">\(\sigma\)</span> parameter is drawn
uniformly from the range [<span class="math notranslate nohighlight">\(\sigma_{min}\)</span>, <span class="math notranslate nohighlight">\(\sigma_{max}\)</span>]. The function, hence, accepts two parameters,
one for the minimum value of <span class="math notranslate nohighlight">\(\sigma\)</span>, and other, for its maximum value.</p>
<p><strong>Salt and Pepper Noise</strong></p>
<p>The salt and pepper noise, also called the shot noise, has a probability <span class="math notranslate nohighlight">\(p\)</span> of disturbing a given pixel. Once a
pixel is perturbed, it has equal probability of being saturated to either 1, or 0.</p>
<p>To specify the salt and pepper noise, you need to specify its probability of disturbing a pixel.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y_1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">salt_and_pepper_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y_2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">salt_and_pepper_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">y_3</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">salt_and_pepper_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">y_4</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">salt_and_pepper_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">y_5</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">salt_and_pepper_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Salt and Pepper Noise&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ground-truth image&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p$=10%&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p$=15%&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p$=25%&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_4</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p$=40%&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p$=50%&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Summary of Salt and Pepper Noise." src="../_images/DataTutorialOut4.png" />
<p><strong>Image Restoration degradations</strong></p>
<p>Image Restoration is a broader topic than image denoising, comprehending corruption models that follow a more general
expression:</p>
<div class="math notranslate nohighlight">
\[\mathbf{y} = \mathbf{H}(\mathbf{x}) + \mathbf{\epsilon},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{H}\)</span> is called the <em>degradation operator</em>. It is clear that when <span class="math notranslate nohighlight">\(\mathbf{H}\)</span> is the identity,
the denoising problem is restored. Due to their similarity, neural networks may be trained to solve both kinds of problems.
Moreover, since the State-of-the-Art is commonly evaluated for both denoising and restoration problems, we have included
two of the most common degradation processes: Super Resolution and JPEG Deblocking.</p>
<p>We encourage you to use the terms denoising and restoration, as well as noise and degradation interchangeably throughout
the dataset.</p>
<p><strong>Super Resolution Noise</strong></p>
<p>Super-Resolution is a sub-problem of Image Restoration where we want to resize an image <span class="math notranslate nohighlight">\((h, w)\)</span> to
<span class="math notranslate nohighlight">\((n\times h, n\times w)\)</span> while minimizing the quality loss. To train a Deep Neural network to perform such task is
equivalent to train a model to restore an image that was deteriorated while performing the resize operation.</p>
<p>To generate images with resolution artifcats, we perform two steps:</p>
<ol class="arabic simple">
<li><p>Take an image of size <span class="math notranslate nohighlight">\([h, w]\)</span>. Downsample it using bicubic interpolation to <span class="math notranslate nohighlight">\([h / n, w / n]\)</span>.</p></li>
<li><p>Upsample it using bicubic interpolation back to <span class="math notranslate nohighlight">\([h, w]\)</span>.</p></li>
</ol>
<p>The resulting image will exhibit low-resolution artifacts, which can be treated as any other kind of artificial noise.
The introduction of resolution artifacts in image is done through the function <code class="xref py py-func docutils literal notranslate"><span class="pre">data.utils.super_resolution_noise()</span></code>,
and the level of degradetaion is controlled through the parameter <em>noise_level</em>, which corresponds to the n,
described in the two steps above.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y_1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">super_resolution_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y_2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">super_resolution_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y_3</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">super_resolution_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">y_4</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">super_resolution_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">y_5</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">super_resolution_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Super Resolution &quot;Noise&quot;&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ground-truth image&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;n=2&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;n=3&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;n=4&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_4</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;n=5&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;n=6&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Summary of Super Resolution Artifacts." src="../_images/DataTutorialOut5.png" />
<p><strong>JPEG Artifacts</strong></p>
<p>As super resolution, JPEG deblocking is another kind of image restoration task, where we want to restore an image that
was degraded by compressing it using JPEG algorithm. The introduction of JPEG artifcats in the image is done by using
<code class="xref py py-func docutils literal notranslate"><span class="pre">data.utils.jpeg_artifacts()</span></code>.  It has one parameter, controlling the intensity of compression, which is
<em>compression_rate</em> (given as a percentage of information lost).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y_1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">super_resolution_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y_2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">super_resolution_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">y_3</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">super_resolution_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">y_4</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">super_resolution_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">75</span><span class="p">)</span>
<span class="n">y_5</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">super_resolution_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;JPEG &quot;Noise&quot;&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ground-truth image&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;compression_rate=10&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;compression_rate=20&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;compression_rate=50&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_4</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;compression_rate=75&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;compression_rate=90&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Summary of JPEG Artifacts." src="../_images/DataTutorialOut5.png" />
<p><strong>Extending Noise Types</strong></p>
<p>In the CleanDatasetGenerator, noise is artificially added to images at each time an image is read from memory.
<strong>You should keep in mind that, if your noising function introduces too much overhead into the batch generation process,
you should avoid specifying it</strong>. Instead, if that is the case, you can add noise to the images, then save the noised ones
on $($DATASETPATH)/in/$ and use them as if they were a “FullDataset” (see bellow).</p>
<p>Each CleanDatasetGenerator has an internal dictionary of noising functions. This dictionary consists of pairs
“function: args”, where function is the noising function that will corupt the data, and args are the arguments for it.
You can specify more than one noise, knowing that they will be applied sequentially, as can be seen bellow,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">noise_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">gaussian_blind_noise</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span>
    <span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">salt_and_pepper_noise</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">valid_generator</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DatasetFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;../../tmp/BSDS500/Valid&quot;</span><span class="p">,</span>
                                             <span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                                             <span class="n">n_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                             <span class="n">noise_config</span><span class="o">=</span><span class="n">noise_config</span><span class="p">,</span>
                                             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;BSDS_Valid&quot;</span><span class="p">)</span>

<span class="n">Ybatch</span><span class="p">,</span> <span class="n">Xbatch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">valid_generator</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">Xbatch</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Ground-Truth&quot;</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">Ybatch</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Noised Image&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Summary of Composed noises." src="../_images/DataTutorialOut7.png" />
</div>
</div>
<div class="section" id="fulldatasetgenerator-class">
<h2>FullDatasetGenerator Class<a class="headerlink" href="#fulldatasetgenerator-class" title="Permalink to this headline">¶</a></h2>
<p>Some other datasets happen to have matched image pairs <span class="math notranslate nohighlight">\(\mathbf{x}_{i}, \mathbf{y}_{i}\)</span>. In that case, instead of
generating an artificial noise to train the dataset, we may use the pairs for training Deep Learning Model, as well as
to assess model quality. Full Datasets need to have the following folder structure,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DatasetName</span><span class="o">/</span>
<span class="o">|--</span> <span class="n">Train</span>
<span class="o">|</span>   <span class="o">|--</span> <span class="ow">in</span>
<span class="o">|</span>   <span class="o">|--</span> <span class="n">ref</span>
<span class="o">|--</span> <span class="n">Valid</span>
<span class="o">|</span>   <span class="o">|--</span> <span class="ow">in</span>
<span class="o">|</span>   <span class="o">|--</span> <span class="n">ref</span>
</pre></div>
</div>
<p>Here we use as example the PolyU real-world denoising dataset. You can either download it from their
<a class="reference external" href="https://github.com/csjunxu/PolyU-Real-World-Noisy-Images-Dataset">Github page</a>, or use the data module to
automatically download it,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">polyu_path</span> <span class="o">=</span> <span class="s2">&quot;./tmp/PolyU/&quot;</span>
<span class="n">data</span><span class="o">.</span><span class="n">download_PolyU</span><span class="p">(</span><span class="n">polyu_path</span><span class="p">)</span>
</pre></div>
</div>
<p>The procedure for creating Full Datasets is quite the same, the only difference being that we do not have to specify the
noise config dictionary. Since DatasetFactory receives the dataset root, it automatically recognizes images in “ref” as
the ground_truth, and images in “in” as the noisy samples, as shown bellow,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">polyU_cropped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DatasetFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;../../tmp/PolyU/Train&quot;</span><span class="p">,</span>
                                           <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
                                           <span class="n">n_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                           <span class="n">name</span><span class="o">=</span><span class="s2">&quot;PolyU_Cropped&quot;</span><span class="p">)</span>

<span class="n">Ybatch</span><span class="p">,</span> <span class="n">Xbatch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">polyU_cropped</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">Xbatch</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Ground-Truth&quot;</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">Ybatch</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Noised Image&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Summary of PolyU images." src="../_images/DataTutorialOut8.png" />
<div class="section" id="creating-a-fulldataset-from-clean-images">
<h3>Creating a FullDataset from clean images<a class="headerlink" href="#creating-a-fulldataset-from-clean-images" title="Permalink to this headline">¶</a></h3>
<p>If your preprocessing or corruption functions happen to introduce too much overhead in the batch generation process, you
may consider using a <code class="xref py py-class docutils literal notranslate"><span class="pre">OpenDenoising.data.FullDatasetGenrator</span></code> instead of a <code class="xref py py-class docutils literal notranslate"><span class="pre">OpenDenoising.data.CleanDatasetGenrator</span></code>.</p>
<p>To do so, you may use the function <code class="xref py py-class docutils literal notranslate"><span class="pre">OpenDenoising.data.generate_full_dataset</span></code>, which executes the exactly same
process of CleanDataset during batch generation, except that it saves the generated images into memory.</p>
<p>For instance, the following snippet reads data from BSDS train images from “./tmp/BSDS500/Train/ref/”, crops
<span class="math notranslate nohighlight">\(40 \times 40\)</span> patches from each image file, and saves these patches to “./tmp/Cropped_40_BSDS_Gauss_25/”.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">OpenDenoising.data.utils</span> <span class="kn">import</span> <span class="n">gaussian_noise</span>
<span class="kn">from</span> <span class="nn">OpenDenoising.data.utils</span> <span class="kn">import</span> <span class="n">gen_patches</span>
<span class="kn">from</span> <span class="nn">OpenDenoising.data.utils</span> <span class="kn">import</span> <span class="n">generate_full_dataset</span>
<span class="n">PATH_TO_IMGS</span> <span class="o">=</span> <span class="s2">&quot;./tmp/BSDS500/Train/ref/&quot;</span>
<span class="n">PATH_TO_SAVE</span> <span class="o">=</span> <span class="s2">&quot;./tmp/Cropped_40_BSDS_Gauss_25/&quot;</span>
<span class="n">generate_full_dataset</span><span class="p">(</span><span class="n">PATH_TO_IMGS</span><span class="p">,</span> <span class="n">PATH_TO_SAVE</span><span class="p">,</span> <span class="n">noise_config</span><span class="o">=</span><span class="p">{</span><span class="n">gaussian_noise</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">]},</span>
                      <span class="n">preprocessing</span><span class="o">=</span><span class="p">[</span><span class="n">partial</span><span class="p">(</span><span class="n">gen_patches</span><span class="p">,</span> <span class="n">patch_size</span><span class="o">=</span><span class="mi">40</span><span class="p">)],</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>After running the code, you may notice that the following folder structure has been created,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">tmp</span><span class="o">/</span><span class="n">BSDS500</span><span class="o">/</span><span class="n">Train</span><span class="o">/</span>
<span class="o">|--</span> <span class="n">Train</span>
<span class="o">|</span>   <span class="o">|--</span> <span class="ow">in</span>
<span class="o">|</span>   <span class="o">|--</span> <span class="n">ref</span>
</pre></div>
</div>
<p>Hence, you may use DatasetFactory to create a FullDataset by specifying “./tmp/BSDS500/Train/” as the images path.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="FilteringModel.html" class="btn btn-neutral float-right" title="Filtering Model tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="BenchmarkTutorial.html" class="btn btn-neutral float-left" title="Example: running evaluation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Eduardo Montesuma, Florian Lemarchand

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>