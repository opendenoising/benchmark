

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Matlab Model tutorial &mdash; OpenDenoising 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Onnx Model tutorial" href="OnnxModel.html" />
    <link rel="prev" title="Matconvnet Model tutorial" href="MatconvnetModel.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> OpenDenoising
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation guide.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmark_api_doc.html">Benchmark API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../examples.html#basic-examples">Basic Examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../examples.html#in-depth-tutorials">In-depth Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="FilteringModel.html">Filtering Model tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="KerasModel.html">Keras Model tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="TfModel.html">Tensorflow Model tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="PytorchModel.html">Pytorch Model tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="MatconvnetModel.html">Matconvnet Model tutorial</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Matlab Model tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#charging-a-model">Charging a model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#from-a-file">From a file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#inference-with-matlabmodel">Inference with MatlabModel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#training-a-matlabmodel">Training a MatlabModel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="OnnxModel.html">Onnx Model tutorial</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#jupyter-notebooks">Jupyter Notebooks</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OpenDenoising</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>Matlab Model tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Examples/MatlabModel.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="matlab-model-tutorial">
<h1>Matlab Model tutorial<a class="headerlink" href="#matlab-model-tutorial" title="Permalink to this headline">Â¶</a></h1>
<p>This tutorial is a part of Model module guide. Here, we explore how you
can use the MatlabModel wrapper to use your Matlab deep learning models
in the benchmark.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Python packages</span>
<span class="kn">import</span> <span class="nn">gc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matlab.engine</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">OpenDenoising</span> <span class="k">import</span> <span class="n">data</span>
<span class="kn">from</span> <span class="nn">OpenDenoising</span> <span class="k">import</span> <span class="n">model</span>
<span class="kn">from</span> <span class="nn">OpenDenoising</span> <span class="k">import</span> <span class="n">evaluation</span>

<span class="n">eng</span> <span class="o">=</span> <span class="n">matlab</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">start_matlab</span><span class="p">()</span>
</pre></div>
</div>
<p>The following function will be used throughout this tutorial to display denoising results,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">display_results</span><span class="p">(</span><span class="n">clean_imgs</span><span class="p">,</span> <span class="n">noisy_imgs</span><span class="p">,</span> <span class="n">rest_images</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Display denoising results.&quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Denoising results using {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">clean_imgs</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Ground-Truth&quot;</span><span class="p">)</span>

        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">noisy_imgs</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Noised Image&quot;</span><span class="p">)</span>

        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">rest_imgs</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Restored Images&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Moreover, you may download the data we will use by using the following function,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">download_BSDS_grayscale</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;./tmp/BSDS500/&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The models will be evaluated using the BSDS dataset,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Validation images generator</span>
<span class="n">valid_generator</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DatasetFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;./tmp/BSDS500/Valid&quot;</span><span class="p">,</span>
                                             <span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                                             <span class="n">n_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                             <span class="n">noise_config</span><span class="o">=</span><span class="p">{</span><span class="n">data</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">gaussian_noise</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">]},</span>
                                             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;BSDS_Valid&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="charging-a-model">
<h2>Charging a model<a class="headerlink" href="#charging-a-model" title="Permalink to this headline">Â¶</a></h2>
<p>To charge a Matlab model, you can either specify a Matlab function or a
.mat file containing the architecture you want to train/test. In both
cases, you need to specify a string.</p>
</div>
<div class="section" id="from-a-file">
<h2>From a file<a class="headerlink" href="#from-a-file" title="Permalink to this headline">Â¶</a></h2>
<p>To charge a model from a file, you need to specify the path to the .mat
file containing the modelâs architecture. Notice that for models that
predict the residual, rather than the restored image, â<strong>return_diff</strong>â
should be specified as True,</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matlabModel</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">MatlabModel</span><span class="p">(</span><span class="n">return_diff</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matlabModel</span><span class="o">.</span><span class="n">charge_model</span><span class="p">(</span><span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;./Additional Files/Matlab Models/dncnn_matlab.mat&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>After charging the model into the wrapper object, the network object will be available on Matlabâs workspace. The
following command prints the workspace:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">matlabModel</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">workspace</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matlab</span><span class="s1">&#39;s Workspace:</span>
<span class="n">Name</span>                   <span class="n">Size</span>              <span class="n">Bytes</span>  <span class="n">Class</span>                                 <span class="n">Attributes</span>

<span class="n">layers</span>                <span class="mi">50</span><span class="n">x1</span>             <span class="mi">4465192</span>  <span class="n">nnet</span><span class="o">.</span><span class="n">cnn</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="n">Layer</span>
</pre></div>
</div>
<div class="section" id="from-a-function">
<h3>From a Function<a class="headerlink" href="#from-a-function" title="Permalink to this headline">Â¶</a></h3>
<p>To specify a model from a function, you need to specify the path to the
.m file that has the function that will build your model. This string is
used internally to add the .m file to the path, and the to call the
function using Matlabâs engine.</p>
<p><strong>Note:</strong> you may still pass extra arguments through kwargs, as if they
were going to feed a normal Python function.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matlabModel2</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">MatlabModel</span><span class="p">(</span><span class="n">return_diff</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;../../logs/Matlab&quot;</span><span class="p">)</span>
<span class="n">matlabModel2</span><span class="o">.</span><span class="n">charge_model</span><span class="p">(</span><span class="n">model_function</span><span class="o">=</span><span class="s2">&quot;../../OpenDenoising/model/architectures/matlab/dncnn.m&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="inference-with-matlabmodel">
<h2>Inference with MatlabModel<a class="headerlink" href="#inference-with-matlabmodel" title="Permalink to this headline">Â¶</a></h2>
<p>To perform inference, you may use the â__call__â method in MatlabModel
class. This method uses the Matlabâs engine to internally call
âdenoiseImageâ matlab function, that uses the network object to denoise
an input batch.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get batch from valid_generator</span>
<span class="n">noisy_imgs</span><span class="p">,</span> <span class="n">clean_imgs</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">valid_generator</span><span class="p">)</span>
<span class="c1"># Performs inference on noisy images</span>
<span class="n">rest_imgs</span> <span class="o">=</span> <span class="n">matlabModel</span><span class="p">(</span><span class="n">noisy_imgs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_results</span><span class="p">(</span><span class="n">clean_imgs</span><span class="p">,</span> <span class="n">noisy_imgs</span><span class="p">,</span> <span class="n">noisy_imgs</span> <span class="o">-</span> <span class="n">rest_imgs</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">matlabModel</span><span class="p">))</span>
</pre></div>
</div>
<img alt="../_images/matlab_output_18_0.png" src="../_images/matlab_output_18_0.png" />
</div>
<div class="section" id="training-a-matlabmodel">
<h2>Training a MatlabModel<a class="headerlink" href="#training-a-matlabmodel" title="Permalink to this headline">Â¶</a></h2>
<p>To train a MatlabModel, you need to specify a training (and possibly a
validation) dataset through a string. This string correspond to the name
of the dataset in Matlabâs workspace.</p>
<p>To create the dataset in the workspace, you can use the classes
âimageDatastoreâ, âCleanMatlabDatasetâ and âFullMatlabDatasetâ, which
are Matlab classes for generating data to train Deep Learning models.</p>
<div class="section" id="using-a-cleandataset">
<h3>Using a CleanDataset<a class="headerlink" href="#using-a-cleandataset" title="Permalink to this headline">Â¶</a></h3>
<p>As in the case of Pythonâs CleanDatasetGenerator, to specify a Clean
Dataset using Matlab you need to specify the noising function, called
noiseFcn. This function should be specified as a string, that has the
<strong>lambda signature</strong> on it.</p>
<p>For instance, if you want to use Gaussia noise on your dataset, you need
to specify:</p>
<p>noiseFcn = â&#64;(I) imnoise(I, âgaussianâ, 0, 25/255)â.</p>
<p>For more complex kinds of functions, you can implement it as a .m
function, and specify its arguments via the same strategy.</p>
<p><strong>Note:</strong> You should make sure that â./OpenDenoising/data/â folder is on
Matlabâs path (add it to pathdef.m).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_train_wrapper</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">MatlabCleanDatasetGenerator</span><span class="p">(</span><span class="n">matlabModel2</span><span class="o">.</span><span class="n">engine</span><span class="p">,</span> <span class="n">images_path</span><span class="o">=</span><span class="s2">&quot;../../tmp/BSDS500/Train/ref&quot;</span><span class="p">,</span>
                                                         <span class="n">partition</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">)</span>
<span class="n">dataset_train_wrapper</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_valid_wrapper</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">MatlabCleanDatasetGenerator</span><span class="p">(</span><span class="n">matlabModel2</span><span class="o">.</span><span class="n">engine</span><span class="p">,</span> <span class="n">images_path</span><span class="o">=</span><span class="s2">&quot;../../tmp/BSDS500/Valid/ref&quot;</span><span class="p">,</span>
                                                         <span class="n">partition</span><span class="o">=</span><span class="s2">&quot;Valid&quot;</span><span class="p">)</span>
<span class="n">dataset_valid_wrapper</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">matlabModel2</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">workspace</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matlab</span><span class="s1">&#39;s Workspace:</span>
<span class="n">Name</span>                   <span class="n">Size</span>              <span class="n">Bytes</span>  <span class="n">Class</span>                                 <span class="n">Attributes</span>

<span class="n">ME</span>                     <span class="mi">1</span><span class="n">x1</span>                <span class="mi">1138</span>  <span class="n">MException</span>
<span class="n">imds_Train</span>             <span class="mi">1</span><span class="n">x1</span>                   <span class="mi">8</span>  <span class="n">matlab</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">datastore</span><span class="o">.</span><span class="n">ImageDatastore</span>
<span class="n">imds_Train_noise</span>       <span class="mi">1</span><span class="n">x1</span>                   <span class="mi">8</span>  <span class="n">CleanMatlabDataset</span>
<span class="n">imds_Valid</span>             <span class="mi">1</span><span class="n">x1</span>                   <span class="mi">8</span>  <span class="n">matlab</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">datastore</span><span class="o">.</span><span class="n">ImageDatastore</span>
<span class="n">imds_Valid_noise</span>       <span class="mi">1</span><span class="n">x1</span>                   <span class="mi">8</span>  <span class="n">CleanMatlabDataset</span>
<span class="n">layers</span>                <span class="mi">50</span><span class="n">x1</span>             <span class="mi">4465192</span>  <span class="n">nnet</span><span class="o">.</span><span class="n">cnn</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="n">Layer</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matlabModel2</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">train_generator</span><span class="o">=</span><span class="s2">&quot;imds_Train_noise&quot;</span><span class="p">,</span> <span class="n">valid_generator</span><span class="o">=</span><span class="s2">&quot;imds_Valid_noise&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opts</span> <span class="o">=</span> <span class="n">trainingOptions</span><span class="p">(</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="s1">&#39;Plots&#39;</span><span class="p">,</span> <span class="s1">&#39;training-progress&#39;</span><span class="p">,</span><span class="s1">&#39;Verbose&#39;</span><span class="p">,</span> <span class="n">true</span><span class="p">,</span><span class="s1">&#39;VerboseFrequency&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span><span class="s1">&#39;MaxEpochs&#39;</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span><span class="s1">&#39;Shuffle&#39;</span><span class="p">,</span> <span class="s1">&#39;every-epoch&#39;</span><span class="p">,</span><span class="s1">&#39;ValidationData&#39;</span><span class="p">,</span> <span class="n">valid_imds</span><span class="p">,</span><span class="s1">&#39;CheckpointPath&#39;</span><span class="p">,</span> <span class="s1">&#39;../../OpenDenoising/training_logs/Matlab&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="OnnxModel.html" class="btn btn-neutral float-right" title="Onnx Model tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="MatconvnetModel.html" class="btn btn-neutral float-left" title="Matconvnet Model tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Eduardo Montesuma, Florian Lemarchand

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>